!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("nattyStorage",[],e):"object"==typeof exports?exports.nattyStorage=e():t.nattyStorage=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var a=n[r]={exports:{},id:r,loaded:!1};return t[r].call(a.exports,a,a.exports,e),a.loaded=!0,a.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";t.exports=n(1)},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t){if(!D[t])return S;var e={x:"x"},n="natty-storage-test",r=i(t);try{r.set(n,e);var a=JSON.stringify(r.get(n))===JSON.stringify(e);return r.remove(n),a}catch(o){return!1}}function o(t){throw new Error(t)}function i(t){return t=window[t],{set:function(e,n){t.setItem(e,JSON.stringify(n))},get:function(e){var n=t.getItem(e);if(!n)return m;try{n=JSON.parse(n)}catch(r){}return n},remove:function(e){t.removeItem(e)}}}function c(){var t=P;return{set:function(e,n){t[e]=n},get:function(e){return e in t?t[e]:m},remove:function(e){delete t[e]}}}function u(t){return t.split(b).reverse().join(b)}function s(t){var e;if(-1===t.indexOf("\\."))e=t.split(".");else{e=u(t).split(/\.(?!\\)/).reverse();for(var n=0,r=e.length;r>n;n++)e[n]=u(e[n].replace(/\.\\/g,"."))}return e}function f(t,e,n){for(var r=s(t),a=n;r.length;){var o=r.shift();if(r.length)a[o]=a[o]||{},a=a[o];else{if(!p(a))throw new Error("Cannot create property `"+o+"` on non-object value, path:`"+t+"`");a[o]=e}}return n}function l(t,e,n){if(n=n||!1,n===!0||-1===t.indexOf("."))return e[t];for(var r=s(t);r.length;){var a=r.shift();if(e=l(a,e,!0),"object"!=typeof e||e===x){r.length&&(e=x);break}}return e}function d(t,e,n){if(n=n||-1===t.indexOf("."))return e.hasOwnProperty(t);for(var r=s(t);r.length;){var a=r.shift(),o=e.hasOwnProperty(a);if(!o||!r.length)return o;if(e=l(a,e,!0),!p(e))return S}}function _(t,e){for(var n=s(t),r=e;n.length;){var a=n.shift();n.length?(r[a]=r[a]||{},r=r[a]):delete r[a]}return e}function g(t){var e=O;for(var n in t){e=S;break}return e}var v=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),h=n(2),y=h.extend,p=h.isPlainObject,w=(h.isObject,h.noop),k=void 0;k="1.1.2";var m=null,b="",O=!0,S=!O,E="_placeholder",x=void 0,D={localStorage:"object"==typeof localStorage,sessionStorage:"object"==typeof sessionStorage},A={localStorage:a("localStorage"),sessionStorage:a("sessionStorage"),variable:O},j={type:"localStorage",key:b,tag:b,duration:0,until:0,async:!1},K=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];r(this,t);var n=this;if(n.config=y({},j,e),!n.config.key)throw new Error("`key` is required when using natty-storage!");n._storage="variable"!==n.config.type&&A[n.config.type]?i(n.config.type):c(),n._CHECK_KEY="nattyStorageCheck:"+n.config.key,n._DATA_KEY="nattyStorageData:"+n.config.key,n._placeholderUsed=S,n._createStamp=+new Date}return v(t,[{key:"_lazyInit",value:function(){var t=this;t._checkData=t._storage.get(t._CHECK_KEY),t._isNew=t._checkData===m,t._isNew||t.isOutdated()?t._storage.set(t._DATA_KEY,t._data={}):(t._data=t._storage.get(t._DATA_KEY),t._data===m&&t._storage.set(t._DATA_KEY,t._data={})),t._storage.set(t._CHECK_KEY,t._checkData={tag:t.config.tag,lastUpdate:t._createStamp,duration:t.config.duration,until:t.config.until})}},{key:"isOutdated",value:function(){var t=this;if(t.config.tag&&t.config.tag!==t._checkData.tag)return O;var e=+new Date;return t._checkData.duration&&e-t._checkData.lastUpdate>t._checkData.duration?O:t._checkData.until&&e>t._checkData.until?O:S}},{key:"set",value:function(t,e){var n=this,r=arguments.length,a=function(a,o){try{n._data||n._lazyInit(),1===r?p(t)?n._data=t:(n._data[E]=t,n._placeholderUsed=O):f(t,e,n._data),n._storage.set(n._DATA_KEY,n._data),a()}catch(i){o(i)}};return n.config.async?new Promise(a):void a(w,o)}},{key:"get",value:function(t){var e=this,n=void 0,r=function(r,a){try{e._data||e._lazyInit(),n=t?l(t,e._data):e._placeholderUsed?e._data[E]:e._data,r(n)}catch(o){a(o)}};return e.config.async?new Promise(r):(r(w,o),n)}},{key:"has",value:function(t){var e=this,n=void 0,r=function(r,a){try{if(e._data||e._lazyInit(),e._placeholderUsed||g(e._data))n=e._data.hasOwnProperty(E)?{has:!0,value:e._data[E]}:{},r(n);else{if(!t)throw new Error("a `path` argument should be passed into the `has` method");n=d(t,e._data)?{has:!0,value:l(t,e._data)}:{},r(n)}}catch(o){a(o)}};return e.config.async?new Promise(r):(r(w,o),n)}},{key:"remove",value:function(t){var e=this,n=function(n,r){try{e._data||e._lazyInit(),t?(_(t,e._data),e._storage.set(e._DATA_KEY,e._data)):e.set({}),n()}catch(a){r(a)}};return e.config.async?new Promise(n):void n(w,o)}},{key:"destroy",value:function(){var t=this;t._storage.remove(t._CHECK_KEY),t._storage.remove(t._DATA_KEY)}},{key:"dump",value:function(){var t=this;t._data||t._lazyInit(),JSON&&console&&console.log(JSON.stringify(this._data,m,4))}}]),t}(),P={},C=function(t){return new K(t)};C.version=k,C._variable=P,C.support=A,t.exports=C},function(t,e,n){"use strict";var r=null,a=function(t){return function(){for(var e=arguments,n=t(e[0],e[1]),r=2,a=e.length;a>r;r++)n=t(n,e[r]);return n}},o="object",i=function(t){return typeof t===o&&t!==r},c=function(t){return t!==r&&t===t.window},u=function(t){return t!==r&&i(t)&&!c(t)&&Object.getPrototypeOf(t)===Object.prototype},s=Array.isArray,f=function d(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];for(var n in e)e.hasOwnProperty(n)&&void 0!==e[n]&&(s(e[n])?t[n]=[].concat(e[n]):u(e[n])?t[n]=d({},e[n]):t[n]=e[n]);return t},l=function(){};t.exports={extend:a(f),noop:l,isPlainObject:u}}])});